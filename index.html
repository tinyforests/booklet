<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Field Guide — Gardener & Son</title>
  
  <!-- Abril Fatface from Google Fonts -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Abril+Fatface&display=swap" rel="stylesheet">
  
  <style>
    /* ========================================
       RESET
       ======================================== */
    
    *, *::before, *::after {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    /* ========================================
       DESIGN TOKENS
       ======================================== */
    
    :root {
      /* Typography */
      --font-serif: 'Abril Fatface', 'Iowan Old Style', 'Palatino Linotype', serif;
      --font-sans: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
      
      /* Type scale — responsive */
      --text-xl: clamp(2.5rem, 6vw, 4rem);      /* Entry title */
      --text-lg: clamp(1.75rem, 4vw, 2.5rem);   /* Section headings */
      --text-md: clamp(1.0625rem, 2vw, 1.25rem);/* Body text */
      --text-sm: 0.875rem;                      /* Navigation */
      --text-xs: 0.75rem;                       /* Footer */
      
      /* Line heights */
      --line-tight: 1.15;
      --line-medium: 1.35;
      --line-relaxed: 1.65;
      
      /* Gardener & Son Brand Colors */
      --gardener-green: #3d4535;
      --nostalgic-beige: #fff0dc;
      --text-primary: #3d4535;
      --text-muted: rgba(61, 69, 53, 0.5);
      --accent: #3d4535;
      
      /* Spacing */
      --space-section: clamp(4rem, 12vh, 8rem);
      --nav-width: 200px;
    }
    
    /* ========================================
       BASE STYLES
       ======================================== */
    
    html {
      font-size: 100%;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
      scroll-behavior: smooth;
    }
    
    body {
      font-family: var(--font-sans);
      font-size: var(--text-md);
      line-height: var(--line-relaxed);
      color: var(--text-primary);
      background: var(--nostalgic-beige);
      overflow-x: hidden;
    }
    
    /* ========================================
       RIGHT-SIDE NAVIGATION (YIELD STYLE)
       ======================================== */
    
    #side-nav {
      position: fixed;
      top: 50%;
      right: 2rem;
      transform: translateY(-50%);
      z-index: 200;
    }
    
    #side-nav__list {
      list-style: none;
      margin: 0;
      padding: 0;
      text-align: right;
    }
    
    .side-nav__item {
      margin-bottom: 0.35rem;
    }
    
    .side-nav__link {
      font-family: var(--font-sans);
      font-size: 0.8rem;
      color: var(--text-muted);
      text-decoration: none;
      cursor: pointer;
      transition: color 200ms ease;
      display: inline-block;
      line-height: 1.3;
    }
    
    .side-nav__link:hover {
      color: var(--text-primary);
    }
    
    .side-nav__link.active {
      color: var(--text-primary);
      font-weight: 500;
    }
    
    /* ========================================
       NAVIGATION ARROWS (PAGE-BY-PAGE)
       ======================================== */
    
    #nav-arrows {
      position: fixed;
      right: 50%;
      bottom: 2rem;
      transform: translateX(50%);
      display: flex;
      gap: 1.5rem;
      z-index: 100;
    }
    
    .nav-arrow {
      width: 2.5rem;
      height: 2.5rem;
      background: none;
      border: 1px solid var(--gardener-green);
      border-radius: 50%;
      color: var(--gardener-green);
      font-size: 1.25rem;
      cursor: pointer;
      transition: all 200ms ease;
      display: flex;
      align-items: center;
      justify-content: center;
      opacity: 0.3;
    }
    
    .nav-arrow:hover {
      background: var(--gardener-green);
      color: var(--nostalgic-beige);
      opacity: 1;
    }
    
    .nav-arrow:disabled {
      opacity: 0.1;
      cursor: not-allowed;
      pointer-events: none;
    }
    
    .nav-arrow:focus {
      outline: 2px solid var(--gardener-green);
      outline-offset: 4px;
      opacity: 1;
    }
    
    /* Subtle bounce animation */
    @keyframes arrowBounce {
      0%, 100% {
        transform: translateY(0);
      }
      50% {
        transform: translateY(-3px);
      }
    }
    
    .nav-arrow--down {
      animation: arrowBounce 2s ease-in-out infinite;
    }
    
    .nav-arrow--up {
      animation: arrowBounce 2s ease-in-out infinite;
      animation-direction: reverse;
    }
    
    /* Stop animation on hover */
    .nav-arrow:hover {
      animation: none;
    }
    
    /* ========================================
       MAIN CONTENT CONTAINER
       ======================================== */
    
    main {
      max-width: 42rem;
      margin: 0 auto;
      padding: 0 2rem;
    }
    
    /* ========================================
       SECTIONS
       ======================================== */
    
    section {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      justify-content: center;
      padding: var(--space-section) 0;
      scroll-margin-top: 2rem;
    }
    
    /* Entry section - centered */
    section.section--entry {
      text-align: center;
      align-items: center;
    }
    
    section.section--entry .section__content {
      max-width: 28rem;
    }
    
    .section__content {
      width: 100%;
    }
    
    /* ========================================
       TYPOGRAPHY
       ======================================== */
    
    h1 {
      font-family: var(--font-serif);
      font-size: var(--text-xl);
      font-weight: 400;
      line-height: var(--line-tight);
      letter-spacing: -0.02em;
      margin-bottom: 2rem;
    }
    
    h2 {
      font-family: var(--font-serif);
      font-size: var(--text-lg);
      font-weight: 400;
      line-height: var(--line-medium);
      letter-spacing: -0.015em;
      margin-bottom: 1.5rem;
    }
    
    p {
      font-family: var(--font-sans);
      font-size: var(--text-md);
      line-height: var(--line-relaxed);
      margin-bottom: 1rem;
    }
    
    p:last-child {
      margin-bottom: 0;
    }
    
    /* Line breaks in content */
    .line-break {
      display: block;
      height: 0.75em;
    }
    
    /* ========================================
       ENTER BUTTON (Entry section only)
       ======================================== */
    
    .enter-button {
      display: inline-block;
      margin-top: 2rem;
      padding: 0.75rem 2rem;
      font-family: var(--font-sans);
      font-size: var(--text-md);
      color: var(--gardener-green);
      background: transparent;
      border: 1px solid var(--gardener-green);
      cursor: pointer;
      transition: all 200ms ease;
      text-decoration: none;
    }
    
    .enter-button:hover {
      background: var(--gardener-green);
      color: var(--nostalgic-beige);
    }
    
    .enter-button:focus {
      outline: 2px solid var(--gardener-green);
      outline-offset: 4px;
    }
    
    /* ========================================
       FOOTER
       ======================================== */
    
    footer {
      text-align: center;
      padding: 4rem 2rem;
      font-size: var(--text-xs);
      color: var(--text-muted);
      opacity: 0.7;
    }
    
    footer p {
      margin: 0;
      line-height: 1.4;
    }
    
    /* ========================================
       ACCESSIBILITY
       ======================================== */
    
    @media (prefers-reduced-motion: reduce) {
      html {
        scroll-behavior: auto;
      }
      
      .side-nav__link {
        transition: none;
      }
    }
    
    /* ========================================
       MOBILE REFINEMENTS
       ======================================== */
    
    @media (max-width: 768px) {
      main {
        padding: 0 1.5rem;
      }
      
      section {
        min-height: 80vh;
        padding: 3rem 0;
      }
      
      /* Move side navigation to top-right on mobile */
      #side-nav {
        position: fixed;
        top: 1rem;
        right: 1rem;
        bottom: auto;
        transform: none;
        background: transparent;
        max-height: calc(100vh - 8rem);
        overflow-y: auto;
      }
      
      #side-nav__list {
        text-align: right;
      }
      
      .side-nav__item {
        margin-bottom: 0.25rem;
      }
      
      .side-nav__link {
        font-size: 0.7rem;
      }
      
      /* Keep arrows at bottom on mobile */
      #nav-arrows {
        bottom: 1.5rem;
      }
      
      .nav-arrow {
        width: 2.25rem;
        height: 2.25rem;
        font-size: 1rem;
      }
    }
    
    @media (max-width: 480px) {
      #side-nav {
        right: 0.75rem;
      }
      
      .side-nav__link {
        font-size: 0.65rem;
      }
      
      .nav-arrow {
        width: 2rem;
        height: 2rem;
      }
    }
  </style>
</head>
<body>

  <!-- Right-side navigation (YIELD style) -->
  <nav id="side-nav" aria-label="Page navigation">
    <ul id="side-nav__list">
      <!-- Populated by JavaScript -->
    </ul>
  </nav>

  <!-- Main content -->
  <main id="main-content">
    <!-- Sections injected here by JavaScript -->
  </main>

  <!-- Footer -->
  <footer id="footer">
    <p>© Gardener & Son<br>Made slowly</p>
  </footer>

  <!-- Navigation arrows for page-by-page -->
  <div id="nav-arrows">
    <button class="nav-arrow nav-arrow--up" id="prev-section" aria-label="Previous section">↑</button>
    <button class="nav-arrow nav-arrow--down" id="next-section" aria-label="Next section">↓</button>
  </div>

  <script>
    // ========================================
    // FIELD GUIDE — VERTICAL SCROLLING
    // YIELD-style navigation
    // ========================================
    
    let sectionsData = [];
    let currentSection = 0;
    let totalSections = 0;
    
    // ========================================
    // INITIALIZATION
    // ========================================
    
    async function init() {
      try {
        const response = await fetch('slides.json');
        const data = await response.json();
        sectionsData = data.slides;
        totalSections = sectionsData.length;
        
        buildSections(sectionsData);
        buildSideNav(sectionsData);
        setupScrollTracking();
        setupArrowNavigation();
        updateArrowStates();
        
      } catch (error) {
        console.error('Failed to load content:', error);
        document.getElementById('main-content').innerHTML = 
          '<section><div class="section__content"><p>Failed to load content. Please refresh.</p></div></section>';
      }
    }
    
    // ========================================
    // BUILD SECTIONS
    // ========================================
    
    function buildSections(sections) {
      const main = document.getElementById('main-content');
      main.innerHTML = '';
      
      sections.forEach((section, index) => {
        const sectionEl = document.createElement('section');
        sectionEl.id = `section-${index}`;
        sectionEl.setAttribute('data-section-index', index);
        
        // Add type class if specified
        if (section.type) {
          sectionEl.classList.add(`section--${section.type}`);
        }
        
        const content = document.createElement('div');
        content.className = 'section__content';
        
        // Entry section with title and button
        if (section.type === 'entry') {
          const title = document.createElement('h1');
          title.textContent = section.title;
          content.appendChild(title);
          
          if (section.subtitle) {
            const subtitle = document.createElement('p');
            subtitle.textContent = section.subtitle;
            content.appendChild(subtitle);
          }
          
          if (section.action) {
            const button = document.createElement('a');
            button.className = 'enter-button';
            button.textContent = section.action;
            button.href = '#section-1';
            content.appendChild(button);
          }
        }
        // Regular section with heading and body
        else {
          if (section.heading) {
            const heading = document.createElement('h2');
            heading.textContent = section.heading;
            content.appendChild(heading);
          }
          
          if (section.body) {
            // Handle line breaks in body text
            const paragraphs = section.body.split('\n\n');
            paragraphs.forEach(para => {
              const p = document.createElement('p');
              // Replace single line breaks with spans for intentional breaks
              p.innerHTML = para.split('\n').join('<span class="line-break"></span>');
              content.appendChild(p);
            });
          }
        }
        
        sectionEl.appendChild(content);
        main.appendChild(sectionEl);
      });
    }
    
    // ========================================
    // BUILD SIDE NAVIGATION
    // ========================================
    
    function buildSideNav(sections) {
      const navList = document.getElementById('side-nav__list');
      navList.innerHTML = '';
      
      sections.forEach((section, index) => {
        const li = document.createElement('li');
        li.className = 'side-nav__item';
        
        const link = document.createElement('a');
        link.className = 'side-nav__link';
        link.href = `#section-${index}`;
        link.setAttribute('data-section-index', index);
        
        // Format as numbered navigation
        if (section.type === 'entry') {
          link.textContent = section.title || 'Entry';
        } else {
          const number = index;
          const title = section.heading || `Section ${index + 1}`;
          link.textContent = `${number} · ${title}`;
        }
        
        // Click handler for smooth scroll
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const targetSection = document.getElementById(`section-${index}`);
          if (targetSection) {
            targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
          }
        });
        
        li.appendChild(link);
        navList.appendChild(li);
      });
    }
    
    // ========================================
    // SCROLL TRACKING
    // ========================================
    
    function setupScrollTracking() {
      // Intersection Observer to track which section is visible
      const options = {
        root: null,
        rootMargin: '-50% 0px -50% 0px',
        threshold: 0
      };
      
      const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
          if (entry.isIntersecting) {
            const sectionIndex = parseInt(entry.target.getAttribute('data-section-index'));
            updateActiveNav(sectionIndex);
          }
        });
      }, options);
      
      // Observe all sections
      document.querySelectorAll('section').forEach(section => {
        observer.observe(section);
      });
    }
    
    function updateActiveNav(sectionIndex) {
      currentSection = sectionIndex;
      
      const links = document.querySelectorAll('.side-nav__link');
      links.forEach((link, index) => {
        if (index === sectionIndex) {
          link.classList.add('active');
        } else {
          link.classList.remove('active');
        }
      });
      
      updateArrowStates();
    }
    
    // ========================================
    // ARROW NAVIGATION
    // ========================================
    
    function setupArrowNavigation() {
      const prevBtn = document.getElementById('prev-section');
      const nextBtn = document.getElementById('next-section');
      
      prevBtn.addEventListener('click', () => {
        if (currentSection > 0) {
          navigateToSection(currentSection - 1);
        }
      });
      
      nextBtn.addEventListener('click', () => {
        if (currentSection < totalSections - 1) {
          navigateToSection(currentSection + 1);
        }
      });
      
      // Keyboard navigation
      document.addEventListener('keydown', (e) => {
        if (e.key === 'ArrowDown' || e.key === 'PageDown') {
          if (currentSection < totalSections - 1) {
            e.preventDefault();
            navigateToSection(currentSection + 1);
          }
        } else if (e.key === 'ArrowUp' || e.key === 'PageUp') {
          if (currentSection > 0) {
            e.preventDefault();
            navigateToSection(currentSection - 1);
          }
        }
      });
    }
    
    function navigateToSection(index) {
      const targetSection = document.getElementById(`section-${index}`);
      if (targetSection) {
        targetSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
        currentSection = index;
        updateArrowStates();
      }
    }
    
    function updateArrowStates() {
      const prevBtn = document.getElementById('prev-section');
      const nextBtn = document.getElementById('next-section');
      
      if (prevBtn && nextBtn) {
        prevBtn.disabled = currentSection === 0;
        nextBtn.disabled = currentSection === totalSections - 1;
      }
    }
    
    // ========================================
    // START
    // ========================================
    
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', init);
    } else {
      init();
    }
  </script>

</body>
</html>
